# 当前项目架构+功能清单分析报告

## 1. 项目概况
- **项目名称**: 水产品微信小程序SaaS平台 (water-mall)
- **部署路径**: `/srv/client-web/www/shui.13982.com/`
- **技术栈**: 
    - **框架**: ThinkPHP 6.0
    - **语言**: PHP
    - **数据库**: MySQL
    - **Web服务器**: Nginx
- **架构模式**: MVC (Model-View-Controller)

## 2. 数据库设计分析
通过对 `schema.sql` 和 `config/database.php` 的分析：
- **数据库名**: `shui_13982_com`
- **主要表结构**:
    - `wyu_shop`: 商户表
    - `wyu_water_order`: 核心订单表
    - `wyu_water_member`: 会员表
    - `wyu_water_mall_product`: 商品表
    - `wyu_water_ticket`: 水票表

## 3. 功能清单梳理

### 3.1 总后台管理端 (Platform Admin)
**访问地址**: `https://shui.13982.com/admin/`
**代码对应**: `app/platform/controller/admin`

- **首页 (Home)**: 数据概览。
- **用户管理 (Account)**: 平台管理员、权限管理。
- **商户管理 (Shop)**:
    - 商户列表与状态管理 (开启/关闭/审核)。
    - 商户入驻流程。
- **应用中心 (Application)**: 插件/SaaS模块管理。
- **系统设置 (Setting)**: 平台全局参数。

### 3.2 商户后台管理端 (Merchant Platform)
**入口**: 总后台 -> 商户列表 -> 进入管理
**代码对应**: `app/water/controller/admin`

- **首页 (Home)**: 数据概览。
- **设置 (Settings)**
    - **门店管理**: 门店列表与详情。
    - **系统配置**: 基础设置。
    - **账号管理**: 商户子账号权限管理。
    - **短信/积分设置**: 营销规则配置。
- **会员 (Member)**
    - **会员管理**: 列表、导入导出 (Import/Export)。
    - **等级/积分/余额**: 资金变动记录。
    - **会员押金**: 桶/饮水机押金管理。
- **优惠券 (Coupon)**
    - **管理**: 上架中/下架过期。
    - **记录**: 发放与使用日志。
- **订水商城 (Water Mall)**
    - **水票管理**: 发行、管理、日志。
    - **商品管理**: 商品发布、分类管理。
    - **订单管理**: 
        - 状态: 待接单/配送中/已完成/已取消。
        - 操作: 派单 (Dispatch)、打印小票。
    - **数据统计**: 销量与GMV统计。
- **合伙人 (Partner)**
    - **合伙体系**: 股东/员工/自定义/会员合伙人。
    - **提现**: 提现记录与审核。
    - **海报库**: 推广物料。
- **小程序 (Mini-Program)**
    - **装修**: 主题设置。
    - **支付**: 支付参数配置。
    - **推荐**: 推荐其他小程序。

## 4. 痛点分析
1. **性能瓶颈**: PHP同步阻塞模式在高并发派单场景下乏力。
2. **架构陈旧**: 缺乏前后端分离，维护成本高。
3. **安全性**: 现有代码可能存在 SQL 注入风险，且框架版本更新滞后。
